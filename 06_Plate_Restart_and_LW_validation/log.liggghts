LIGGGHTS (Version LIGGGHTS-PUBLIC 3.8.0, compiled 2018-12-24-10:52:11 by karl, git commit 28301df8853491784b1d8b90533ea89b8c6af1e8)
### Reservoir Initialization
### This simulation involves inserting a set of particles into a cylindrical domain
### allowing them to settle under the force of gravity and saving their state for later runs


### Variables ----------------------------------------------------------------------------------------

variable youngmod equal 1.0e7
variable poisson equal 0.3
variable crest equal 0.65
variable cfric equal 1
variable rho equal 1260

variable nmaterials equal 2

variable nP equal 20000
variable tStep equal 1.0e-4
variable prate equal 9000
variable tSettle equal ${nP}/${prate}/${tStep}+1/${tStep}
variable tSettle equal 20000/${prate}/${tStep}+1/${tStep}
variable tSettle equal 20000/9000/${tStep}+1/${tStep}
variable tSettle equal 20000/9000/0.0001+1/${tStep}
variable tSettle equal 20000/9000/0.0001+1/0.0001

print "tSettle = ${tSettle}"
tSettle = 32222.2222222222

variable minRad equal 0.01
variable ndist equal 2*${minRad}
variable ndist equal 2*0.01

variable rcyl equal 0.35
variable zbottom equal -0.5
variable ztop equal 0.6

variable fdump equal 1000


### Initialization -----------------------------------------------------------------------------------

units si
atom_style sphere
atom_modify map array
boundary f f f
newton off
communicate single vel yes

# Declare domain
region domain cylinder z 0 0 ${rcyl} ${zbottom} ${ztop} units box
region domain cylinder z 0 0 0.35 ${zbottom} ${ztop} units box
region domain cylinder z 0 0 0.35 -0.5 ${ztop} units box
region domain cylinder z 0 0 0.35 -0.5 0.6 units box
create_box 2 domain
Created orthogonal box = (-0.35 -0.35 -0.5) to (0.35 0.35 0.6)
  1 by 2 by 2 MPI processor grid

# Neighbor listing
neighbor ${ndist} bin
neighbor 0.02 bin
neigh_modify every 1 check no delay 0


### Setup -------------------------------------------------------------------------------------------

# Material and interaction properties required
fix m1 all property/global youngsModulus peratomtype ${youngmod} ${youngmod}
fix m1 all property/global youngsModulus peratomtype 10000000 ${youngmod}
fix m1 all property/global youngsModulus peratomtype 10000000 10000000
fix m2 all property/global poissonsRatio peratomtype ${poisson} ${poisson}
fix m2 all property/global poissonsRatio peratomtype 0.3 ${poisson}
fix m2 all property/global poissonsRatio peratomtype 0.3 0.3
fix m3 all property/global coefficientRestitution peratomtypepair 2 ${crest} ${crest} ${crest} ${crest}
fix m3 all property/global coefficientRestitution peratomtypepair 2 0.65 ${crest} ${crest} ${crest}
fix m3 all property/global coefficientRestitution peratomtypepair 2 0.65 0.65 ${crest} ${crest}
fix m3 all property/global coefficientRestitution peratomtypepair 2 0.65 0.65 0.65 ${crest}
fix m3 all property/global coefficientRestitution peratomtypepair 2 0.65 0.65 0.65 0.65
fix m4 all property/global coefficientFriction peratomtypepair 2 ${cfric} 0 0 ${cfric}
fix m4 all property/global coefficientFriction peratomtypepair 2 1 0 0 ${cfric}
fix m4 all property/global coefficientFriction peratomtypepair 2 1 0 0 1
fix m5 all property/global cohesionEnergyDensity peratomtypepair 2 100 0 0 100
fix m6 all property/global coefficientRollingFriction peratomtypepair 2 0.04 0.04 0.04 0.04

# Particle insertion

fix pts1 all particletemplate/sphere 49979693 atom_type 1 density constant ${rho} radius constant ${minRad}
fix pts1 all particletemplate/sphere 49979693 atom_type 1 density constant 1260 radius constant ${minRad}
fix pts1 all particletemplate/sphere 49979693 atom_type 1 density constant 1260 radius constant 0.01
fix pts2 all particletemplate/sphere 15485863 atom_type 1 density constant ${rho} radius constant 0.02
fix pts2 all particletemplate/sphere 15485863 atom_type 1 density constant 1260 radius constant 0.02
fix pts3 all particletemplate/sphere 15485867 atom_type 1 density constant ${rho} radius constant 0.03
fix pts3 all particletemplate/sphere 15485867 atom_type 1 density constant 1260 radius constant 0.03
fix pts4 all particletemplate/sphere 67867967 atom_type 1 density constant ${rho} radius constant 0.05
fix pts4 all particletemplate/sphere 67867967 atom_type 1 density constant 1260 radius constant 0.05
fix pdd all particledistribution/discrete 32452843 4 pts1 0.60 pts2 0.25 pts3 0.1 pts4 0.05


region reservoir cylinder z 0 0 ${rcyl} 0 ${ztop} units box
region reservoir cylinder z 0 0 0.35 0 ${ztop} units box
region reservoir cylinder z 0 0 0.35 0 0.6 units box

fix ins all insert/rate/region seed 49979687 distributiontemplate pdd nparticles ${nP} particlerate ${prate} insert_every 1000 overlapcheck yes vel constant 0. 0. 0. region reservoir ntry_mc 10000
fix ins all insert/rate/region seed 49979687 distributiontemplate pdd nparticles 20000 particlerate ${prate} insert_every 1000 overlapcheck yes vel constant 0. 0. 0. region reservoir ntry_mc 10000
fix ins all insert/rate/region seed 49979687 distributiontemplate pdd nparticles 20000 particlerate 9000 insert_every 1000 overlapcheck yes vel constant 0. 0. 0. region reservoir ntry_mc 10000


# Define the physics
pair_style gran model hertz tangential history cohesion sjkr
pair_coeff * *


### Import CAD / Generate Solids --------------------------------------------------------------------

# Add a granular wall at the floor of the bounding box too
fix zwalls all wall/gran model hertz tangential history primitive type 1 zplane ${zbottom}
fix zwalls all wall/gran model hertz tangential history primitive type 1 zplane -0.5
fix cylwall all wall/gran model hertz tangential history primitive type 1 zcylinder ${rcyl} 0 0
fix cylwall all wall/gran model hertz tangential history primitive type 1 zcylinder 0.35 0 0

### Detailed Settings -------------------------------------------------------------------------------

# Integrator
fix integrator all nve/sphere

# Gravity
fix grav all gravity 9.81 vector 0.0 0.0 -1.0

# Time step
timestep ${tStep}
timestep 0.0001

### Thermodynamic output settings
# none

# Check time step and initialize dump file
fix ctg all check/timestep/gran 1 0.01 0.01
run 1
Setting up run at Tue Apr 30 06:57:23 2019

INFO: Particle insertion ins: 900.000000 particles every 1000 steps - particle rate 9000.000000, (mass rate 7.476289e+01)
      20000 particles (mass 1.661398e+02) within 22000 steps
Memory usage per processor = 4.24693 Mbytes
    Step    Atoms         KinEng            CPU 
       0        0              0              0 
INFO: Particle insertion ins: inserted 900 particle templates (mass 8.470990e+00) at step 1
 - a total of 900 particle templates (mass 8.470990e+00) inserted so far.
WARNING: time-step is 16.276787 % of rayleigh time (../fix_check_timestep_gran.cpp:200)
WARNING: time-step is 8.235596 % of hertz time (../fix_check_timestep_gran.cpp:208)
       1      900      2.2821673    0.014500874 
Loop time of 0.0145207 on 4 procs for 1 steps with 900 atoms, finish time Tue Apr 30 06:57:23 2019


Pair  time (%) = 9.5423e-05 (0.657152)
Neigh time (%) = 0.00191478 (13.1866)
Comm  time (%) = 0.000698009 (4.807)
Outpt time (%) = 0.000146358 (1.00793)
Other time (%) = 0.0116661 (80.3413)

Nlocal:    225 ave 417 max 37 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:    105 ave 151 max 62 min
Histogram: 2 0 0 0 0 0 0 0 1 1
Neighs:    118.75 ave 250 max 10 min
Histogram: 2 0 0 0 0 0 0 1 0 1

Total # of neighbors = 475
Ave neighs/atom = 0.527778
Neighbor list builds = 1
Dangerous builds = 0
