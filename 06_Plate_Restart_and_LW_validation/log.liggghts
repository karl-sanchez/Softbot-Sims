LIGGGHTS (Version LIGGGHTS-PUBLIC 3.8.0, compiled 2018-12-24-10:52:11 by karl, git commit 28301df8853491784b1d8b90533ea89b8c6af1e8)
### Reservoir Initialization
### This simulation involves inserting a set of particles into a cylindrical domain
### allowing them to settle under the force of gravity and saving their state for later runs


### Variables
variable nP equal 50000
variable tStep equal 1.0e-4
variable tSettle equal 20000
variable vmax equal 0.02
variable accel equal 0.01
variable rcyl equal 0.3
variable rbottom equal -0.5
### Initialization

units si
atom_style sphere
atom_modify map array
boundary f f f
newton off
communicate single vel yes

# Declare domain
# region domain block -0.5 0.5 -0.5 0.5 ${rbottom} 0.5 units box
region domain cylinder z 0 0 0.3 ${rbottom} 0.5 units box
region domain cylinder z 0 0 0.3 -0.5 0.5 units box

create_box 2 domain
Created orthogonal box = (-0.3 -0.3 -0.5) to (0.3 0.3 0.5)
  2 by 1 by 2 MPI processor grid

# Neighbor listing
neighbor 0.01 bin
neigh_modify every 1 check no delay 0

### Setup -------------------------------------------------------------------------------------------

# Material and interaction properties required
fix m1 all property/global youngsModulus peratomtype 1.0e7 1.0e7
fix m2 all property/global poissonsRatio peratomtype 0.25 0.25
fix m3 all property/global coefficientRestitution peratomtypepair 2 0.65 0.65 0.65 0.65
fix m4 all property/global coefficientFriction peratomtypepair 2 1 1 1 1
fix m5 all property/global cohesionEnergyDensity peratomtypepair 2 50 0 0 50
fix m6 all property/global coefficientRollingFriction peratomtypepair 2 0.04 0.04 0.04 0.04

# Particle insertion

fix pts1 all particletemplate/sphere 49979693 atom_type 1 density constant 3110 radius constant 0.005
fix pts2 all particletemplate/sphere 15485863 atom_type 1 density constant 3110 radius constant 0.01
fix pts3 all particletemplate/sphere 15485867 atom_type 1 density constant 3110 radius constant 0.03
fix pts4 all particletemplate/sphere 67867967 atom_type 1 density constant 3110 radius constant 0.05
fix pdd all particledistribution/discrete 32452843 4 pts1 0.60 pts2 0.25 pts3 0.1 pts4 0.05


# region reservoir block -0.5 0.5 -0.5 0.5 -1.0 0.0 units box
region reservoir cylinder z 0 0 ${rcyl} ${rbottom} 0 units box
region reservoir cylinder z 0 0 0.3 ${rbottom} 0 units box
region reservoir cylinder z 0 0 0.3 -0.5 0 units box

fix ins all insert/rate/region seed 49979687 distributiontemplate pdd nparticles ${nP} particlerate 15000 insert_every 1000 overlapcheck yes vel constant 0. 0. 0. region reservoir ntry_mc 10000
fix ins all insert/rate/region seed 49979687 distributiontemplate pdd nparticles 50000 particlerate 15000 insert_every 1000 overlapcheck yes vel constant 0. 0. 0. region reservoir ntry_mc 10000


# Define the physics
pair_style gran model hertz tangential history cohesion sjkr rolling_friction cdt
WARNING: 
	The contact model you specified is not located in any whitelist.
	Because of this the model will be run in an unoptimized version (increasing runtime by up to 20%).
	In order to optimize this model you have the following options:
		(i)  Run the genAutoExamplesWhitelist.sh script in your LIGGGHTS(R) source folder to automatically parse the input script
		(ii) Add the model combination by hand to your style_contact_model_user.whitelist that can be found in your LIGGGHTS(R) source folder
	If you perform one of the steps above LIGGGHTS(R) needs to be recompiled to generate the optimized code.

 (../contact_models.h:364)
pair_coeff * *


### Import CAD / Generate Solids --------------------------------------------------------------------

# Add a granular wall at the floor of the bounding box too
fix zwalls all wall/gran model hertz tangential history primitive type 1 zplane ${rbottom}
fix zwalls all wall/gran model hertz tangential history primitive type 1 zplane -0.5
fix cylwall all wall/gran model hertz tangential history primitive type 1 zcylinder ${rcyl} 0 0
fix cylwall all wall/gran model hertz tangential history primitive type 1 zcylinder 0.3 0 0

### Detailed Settings -------------------------------------------------------------------------------

# Integrator
fix integrator all nve/sphere

# Gravity
fix grav all gravity 9.81 vector 0.0 0.0 -1.0

# Time step
timestep ${tStep}
timestep 0.0001

### Thermodynamic output settings
# none

# Check time step and initialize dump file
fix ctg all check/timestep/gran 1 0.01 0.01
run 1
Setting up run at Tue Apr 23 07:33:34 2019

INFO: Particle insertion ins: 1500.000000 particles every 1000 steps - particle rate 15000.000000, (mass rate 3.866305e+01)
      50000 particles (mass 1.288768e+02) within 33000 steps
Memory usage per processor = 4.24533 Mbytes
    Step    Atoms         KinEng            CPU 
       0        0              0              0 
INFO: Particle insertion ins: inserted 1500 particle templates (mass 6.539623e+00) at step 1
 - a total of 1500 particle templates (mass 6.539623e+00) inserted so far.
WARNING: time-step is 20.944829 % of rayleigh time (../fix_check_timestep_gran.cpp:200)
WARNING: time-step is 10.757402 % of hertz time (../fix_check_timestep_gran.cpp:208)
       1     1500     0.27320733    0.008380076 
Loop time of 0.00841742 on 4 procs for 1 steps with 1500 atoms, finish time Tue Apr 23 07:33:34 2019


Pair  time (%) = 1.37595e-05 (0.163465)
Neigh time (%) = 0.00111492 (13.2454)
Comm  time (%) = 0.000486706 (5.78213)
Outpt time (%) = 0.000100866 (1.1983)
Other time (%) = 0.00670117 (79.6107)

Nlocal:    375 ave 752 max 0 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:    149.25 ave 192 max 109 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:    57.5 ave 118 max 0 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 230
Ave neighs/atom = 0.153333
Neighbor list builds = 1
Dangerous builds = 0
unfix ctg

# Dump Files for Post-Processing --------------------------------------------------------------------

dump dmp all custom/vtk 1000 postInit/plate_*.vtk id type type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius

# Run simulation for N time steps ------------------------------------------------------------------

# Allow Particles to settle
run ${tSettle}
run 20000
Setting up run at Tue Apr 23 07:33:34 2019

Memory usage per processor = 7.35896 Mbytes
    Step    Atoms         KinEng            CPU 
       1     1500     0.27320733              0 
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.308893e+00) at step 1001
 - a total of 3000 particle templates (mass 9.848516e+00) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.647599e+00) at step 2001
 - a total of 4500 particle templates (mass 1.349611e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.647599e+00) at step 3001
 - a total of 6000 particle templates (mass 1.714371e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.986304e+00) at step 4001
 - a total of 7500 particle templates (mass 2.113002e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.286095e+00) at step 5001
 - a total of 9000 particle templates (mass 2.441611e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.647599e+00) at step 6001
 - a total of 10500 particle templates (mass 2.806371e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.286095e+00) at step 7001
 - a total of 12000 particle templates (mass 3.134981e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.974905e+00) at step 8001
 - a total of 13500 particle templates (mass 3.532471e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.986304e+00) at step 9001
 - a total of 15000 particle templates (mass 3.931102e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.647599e+00) at step 10001
 - a total of 16500 particle templates (mass 4.295861e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 5.262964e+00) at step 11001
 - a total of 18000 particle templates (mass 4.822158e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 4.325010e+00) at step 12001
 - a total of 19500 particle templates (mass 5.254659e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.647599e+00) at step 13001
 - a total of 21000 particle templates (mass 5.619419e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.297494e+00) at step 14001
 - a total of 22500 particle templates (mass 5.949168e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.986304e+00) at step 15001
 - a total of 24000 particle templates (mass 6.347798e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.647599e+00) at step 16001
 - a total of 25500 particle templates (mass 6.712558e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.297494e+00) at step 17001
 - a total of 27000 particle templates (mass 7.042308e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.647599e+00) at step 18001
 - a total of 28500 particle templates (mass 7.407068e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.647599e+00) at step 19001
 - a total of 30000 particle templates (mass 7.771827e+01) inserted so far.
INFO: Particle insertion ins: inserted 1500 particle templates (mass 3.636200e+00) at step 20001
 - a total of 31500 particle templates (mass 8.135447e+01) inserted so far.
   20001    31449      8.1614372       2710.994 
Loop time of 2710.99 on 4 procs for 20000 steps with 31449 atoms, finish time Tue Apr 23 08:18:45 2019


Pair  time (%) = 53.136 (1.96002)
Neigh time (%) = 1259.9 (46.4737)
Comm  time (%) = 1376.96 (50.7918)
Outpt time (%) = 2.138 (0.0788642)
Other time (%) = 18.8579 (0.695609)

Nlocal:    7862.25 ave 15822 max 15 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Nghost:    2218.5 ave 4349 max 237 min
Histogram: 2 0 0 0 0 0 0 0 0 2
Neighs:    106618 ave 217996 max 1 min
Histogram: 2 0 0 0 0 0 0 0 0 2

Total # of neighbors = 426470
Ave neighs/atom = 13.5607
Neighbor list builds = 20000
Dangerous builds = 0

# Save Reservoir for future use

write_restart restart/restart.equil
